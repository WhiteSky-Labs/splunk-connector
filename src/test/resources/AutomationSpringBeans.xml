<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns:util="http://www.springframework.org/schema/util"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd">

    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="${SPLUNK_CREDENTIALS}"/>
    </bean>


    <bean id="randomShortString" class="org.mule.modules.tests.ConnectorTestUtils"
          factory-method="generateRandomShortString" scope="prototype"/>
    <bean id="secondRandomShortString" class="org.mule.modules.tests.ConnectorTestUtils"
          factory-method="generateRandomShortString" scope="prototype"/>
    <util:constant static-field="org.mule.modules.splunk.SearchMode.NORMAL" id="searchModeNormal"/>
    <util:constant static-field="org.mule.modules.splunk.OutputMode.XML" id="outputModeXML"/>

    <!--getApplications-->
    <util:map id="getApplicationsTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
    </util:map>
    <!--getJobs-->
    <util:map id="getJobsTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
    </util:map>
    <!--runBlockingSearch-->
    <util:map id="invalidBlockingSearchArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="invalid" value="invalid value"/>
        <entry key="invalid 2" value="more invalid data"/>
    </util:map>
    <util:map id="validBlockingSearchArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="timeout" value="60"/>
        <entry key="auto_pause" value="0"/>
    </util:map>

    <util:map id="runBlockingSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="search-args" value=""/>
    </util:map>
    <util:map id="runBlockingSearchTestDataWithInvalidProperties" key-type="java.lang.String"
              map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="searchArgs" value-ref="invalidBlockingSearchArgs"/>
    </util:map>
    <util:map id="runBlockingSearchTestDataWithValidProperties" key-type="java.lang.String"
              map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="searchArgs" value-ref="validBlockingSearchArgs"/>
    </util:map>

    <!--runOneShotSearch-->
    <util:map id="oneshotArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="description" value="Sample Description"/>
    </util:map>
    <util:map id="invalidOneshotArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="invalid" value="invalid value"/>
    </util:map>


    <util:map id="runOneShotSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="earliestTime" value="-10d"/>
        <entry key="latestTime" value="now"/>
        <entry key="args" value-ref="oneshotArgs"/>
    </util:map>
    <util:map id="runOneShotSearchTestDataWithInvalidArgs" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="earliestTime" value="-10d"/>
        <entry key="latestTime" value="now"/>
        <entry key="args" value-ref="invalidOneshotArgs"/>
    </util:map>

    <!--getSavedSearches-->
    <util:map id="getSavedSearchesTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="app" value="search"/>
        <entry key="owner" value="admin"/>
    </util:map>
    <!--createSavedSearch-->
    <util:map id="createSavedSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchName" value-ref="randomShortString"/>
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="search-args" value=""/>
    </util:map>
    <util:map id="createDuplicateSavedSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchName" value-ref="secondRandomShortString"/>
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="search-args" value=""/>
    </util:map>
    <!--viewSavedSearchProperties-->
    <util:map id="viewSavedSearchPropertiesTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="app" value="search"/>
        <entry key="owner" value="admin"/>
    </util:map>
    <!--modifySavedSearchProperties-->
    <util:map id="searchPropertiesMap" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="description" value="Sample Description"/>
        <entry key="is_scheduled" value="true"/>
        <entry key="cron_schedule" value="15 4 * * 6"/>
    </util:map>
    <util:map id="modifySavedSearchPropertiesTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="searchPropertiesRef" value-ref="searchPropertiesMap"/>
    </util:map>
    <util:map id="invalidSearchPropertiesMap" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="description" value="Sample Description"/>
        <entry key="is_scheduled" value="true"/>
        <entry key="invalid" value="invalid test data"/>
    </util:map>
    <util:map id="modifySavedSearchPropertiesInvalidTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="searchPropertiesRef" value-ref="invalidSearchPropertiesMap"/>
    </util:map>
    <util:map id="emptySearchPropertiesMap" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
    </util:map>
    <util:map id="modifySavedSearchPropertiesEmptyTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="searchPropertiesRef" value-ref="emptySearchPropertiesMap"/>
    </util:map>
    <!--getSavedSearchHistory-->
    <util:map id="getSavedSearchHistoryTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="app" value="search"/>
        <entry key="owner" value="admin"/>
    </util:map>
    <!--runSavedSearch-->
    <util:map id="runSavedSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
    </util:map>
    <!--runSavedSearchWithArguments-->
    <util:map id="savedSearchCustomArgsMap" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="mysourcetype" value="*"/>
    </util:map>
    <util:map id="savedSearchDispatchArgsMap" map-class="java.util.HashMap" key-type="java.lang.String"
              value-type="java.lang.Object">
        <entry key="earliest_time" value="-20h"/>
        <entry key="latest_time" value="now"/>
    </util:map>
    <util:map id="invalidSavedSearchCustomArgsMap" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="invalid" value="invalid"/>
    </util:map>
    <util:map id="invalidSavedSearchDispatchArgsMap" map-class="java.util.HashMap" key-type="java.lang.String"
              value-type="java.lang.Object">
        <entry key="invalid" value="invalid"/>
    </util:map>
    <util:map id="runSavedSearchWithArgumentsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="custom-args" value-ref="savedSearchCustomArgsMap"/>
        <entry key="search-dispatch-args" value-ref="savedSearchDispatchArgsMap"/>
    </util:map>
    <util:map id="runSavedSearchWithInvalidArgumentsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype" value-type="java.lang.Object">
        <entry key="searchName" value="Test Search"/>
        <entry key="custom-args" value-ref="invalidSavedSearchCustomArgsMap"/>
        <entry key="search-dispatch-args" value-ref="invalidSavedSearchDispatchArgsMap"/>
    </util:map>
    <!--deleteSavedSearch-->
    <util:map id="deleteSavedSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchName" value-ref="randomShortString"/>
    </util:map>
    <!--getDataModel-->
    <util:map id="getDataModelTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="dataModelName" value="internal_audit_logs"/>
    </util:map>
    <!--getDataModels-->
    <util:map id="getDataModelsTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
    </util:map>
    <!--runExportSearch-->
    <util:map id="exportSearchArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="description" value="Sample Description"/>
    </util:map>
    <util:map id="runExportSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search index=_internal | head 10"/>
        <entry key="earliestTime" value="-1h"/>
        <entry key="latestTime" value="now"/>
    </util:map>
    <!--runRealTimeSearch-->
    <util:map id="runRealTimeSearchData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search * | head 100"/>
        <entry key="earliestTime" value="-1h"/>
        <entry key="latestTime" value="now"/>
    </util:map>
    <!--runNormalSearch-->
    <util:map id="normalSearchArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="description" value="Sample Description"/>
    </util:map>
    <util:map id="runNormalSearchTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="searchQuery" value="search index=_internal | head 10"/>
        <entry key="searchArgs" value-ref="normalSearchArgs"/>
    </util:map>
    <!--getInputs-->
    <util:map id="getInputsTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
    </util:map>
    <!-- createInputs -->
    <util:map id="createInputArgs" map-class="java.util.HashMap"
              key-type="java.lang.String" value-type="java.lang.Object">
        <entry key="index" value="test_index"/>
    </util:map>
    <!--createActiveDirectoryInput-->
    <util:map id="createActiveDirectoryInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="domainControllerName" value="Test-Domain-Controller"/>
    </util:map>
    <util:map id="createActiveDirectoryInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="domainControllerName" value="Test-Domain-Controller"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createMonitorInput-->
    <util:map id="createMonitorInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="monitorPath" value="/var/syslog"/>
    </util:map>
    <util:map id="createMonitorInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="monitorPath" value="/var/syslog"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createScriptInput-->
    <util:map id="createScriptInputTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="scriptName" value="test.sh"/>
    </util:map>
    <util:map id="createScriptInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="scriptName" value="test.sh"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createTcpCookedInput-->
    <util:map id="createTcpCookedInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="portNumber" value="9191"/>
    </util:map>
    <util:map id="createTcpCookedInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="portNumber" value="9191"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createTcpRawInput-->
    <util:map id="createTcpRawInputTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="portNumber" value="9191"/>
    </util:map>
    <util:map id="createTcpRawInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="portNumber" value="9191"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createUdpInput-->
    <util:map id="createUdpInputTestData" key-type="java.lang.String" map-class="java.util.HashMap" scope="prototype"
              value-type="java.lang.Object">
        <entry key="portNumber" value="9191"/>
    </util:map>
    <util:map id="createUdpInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="portNumber" value="9191"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createWindowsEventLogInput-->
    <util:map id="createWindowsEventLogInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="collectionName" value="TestCollection"/>
    </util:map>
    <util:map id="createWindowsEventLogInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="collectionName" value="TestCollection"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createWindowsPerfmonInput-->
    <util:map id="createWindowsPerfmonInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="collectionName" value="TestCollection"/>
    </util:map>
    <util:map id="createWindowsPerfmonInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="collectionName" value="TestCollection"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createWindowsWmiInput-->
    <util:map id="createWindowsWmiInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="collectionName" value="TestCollection"/>
    </util:map>
    <util:map id="createWindowsWmiInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="collectionName" value="TestCollection"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--createWindowsRegistryInput-->
    <util:map id="createWindowsRegistryInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="configurationStanza" value="Test"/>
    </util:map>
    <util:map id="createWindowsRegistryInputWithArgsTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="configurationStanza" value="Test"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--modifyInput-->
    <util:map id="modifyInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="input" value="Placeholder"/>
        <entry key="properties" value-ref="createInputArgs"/>
    </util:map>
    <!--getInput-->
    <util:map id="getInputTestData" key-type="java.lang.String" map-class="java.util.HashMap"
              scope="prototype"
              value-type="java.lang.Object">
        <entry key="inputIdentifier" value="/var/syslog"/>
    </util:map>
</beans>
