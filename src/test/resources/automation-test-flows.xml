<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:splunk="http://www.mulesoft.org/schema/mule/splunk"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:context="http://www.springframework.org/schema/context"
      xmlns:vm="http://www.mulesoft.org/schema/mule/vm"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      version="EE-3.5.0"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.mulesoft.org/schema/mule/splunk http://www.mulesoft.org/schema/mule/splunk/current/mule-splunk.xsd
	    http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd"
        >


    <context:property-placeholder location="${SPLUNK_CREDENTIALS}"/>

    <splunk:config port="${splunk.port}" username="${splunk.username}" host="${splunk.host}"
                   password="${splunk.password}" name="Splunk" doc:name="Splunk"></splunk:config>

    <flow name="get-applications" doc:name="get-applications">
        <splunk:get-applications config-ref="Splunk" doc:name="Splunk"/>
    </flow>

    <flow name="get-jobs" doc:name="get-jobs">
        <splunk:get-jobs config-ref="Splunk" doc:name="Splunk"/>
    </flow>

    <flow name="run-blocking-search" doc:name="run-blocking-search">
        <splunk:run-blocking-search config-ref="Splunk" searchQuery="#[flowVars.searchQuery]" doc:name="Splunk">
            <splunk:search-args ref="#[flowVars.searchArgs]"/>
        </splunk:run-blocking-search>
    </flow>

    <flow name="run-one-shot-search" doc:name="run-one-shot-search">
        <splunk:run-one-shot-search config-ref="Splunk" searchQuery="#[flowVars.searchQuery]"
                                    earliestTime="#[flowVars.earliestTime]" latestTime="#[flowVars.latestTime]"
                                    doc:name="Splunk">
            <splunk:args ref="#[flowVars.args]"/>
        </splunk:run-one-shot-search>
    </flow>

    <flow name="get-saved-searches" doc:name="get-saved-searches">
        <splunk:get-saved-searches config-ref="Splunk" doc:name="Splunk"/>
    </flow>

    <flow name="create-saved-search" doc:name="create-saved-search">
        <splunk:create-saved-search config-ref="Splunk" searchName="#[flowVars.searchName]"
                                    searchQuery="#[flowVars.searchQuery]" doc:name="Splunk">
            <splunk:search-args ref="#[flowVars.SearchArgsRef]"/>
        </splunk:create-saved-search>
    </flow>

    <flow name="view-saved-search-properties" doc:name="view-saved-search-properties">
        <splunk:view-saved-search-properties config-ref="Splunk" searchName="#[flowVars.searchName]" doc:name="Splunk"/>
    </flow>

    <flow name="modify-saved-search-properties" doc:name="modify-saved-search-properties">
        <splunk:modify-saved-search-properties config-ref="Splunk" searchName="#[flowVars.searchName]"
                                               doc:name="Splunk">
            <splunk:search-properties ref="#[flowVars.SearchPropertiesRef]"/>
        </splunk:modify-saved-search-properties>
    </flow>

    <flow name="get-saved-search-history" doc:name="get-saved-search-history">
        <splunk:get-saved-search-history config-ref="Splunk" doc:name="Splunk"/>
    </flow>

    <flow name="run-saved-search" doc:name="run-saved-search">
        <splunk:run-saved-search config-ref="Splunk" searchName="#[flowVars.searchName]" doc:name="Splunk"/>
    </flow>

    <flow name="run-saved-search-with-arguments" doc:name="run-saved-search-with-arguments">
        <splunk:run-saved-search-with-arguments config-ref="Splunk" searchName="#[flowVars.searchName]"
                                                doc:name="Splunk">
            <splunk:custom-args ref="#[flowVars.CustomArgsRef]"/>
            <splunk:search-dispatch-args ref="#[flowVars.SearchDispatchArgsRef]"/>
        </splunk:run-saved-search-with-arguments>
    </flow>

    <flow name="delete-saved-search" doc:name="delete-saved-search">
        <splunk:delete-saved-search config-ref="Splunk" searchName="#[flowVars.searchName]" doc:name="Splunk"/>
    </flow>

    <flow name="get-data-model" doc:name="get-data-model">
        <splunk:get-data-model config-ref="Splunk" dataModelName="#[flowVars.dataModelName]" doc:name="Splunk"/>
    </flow>

    <flow name="get-data-models" doc:name="get-data-models">
        <splunk:get-data-models config-ref="Splunk" doc:name="Splunk"/>
    </flow>

    <flow name="run-export-search" doc:name="run-export-search" initialState="stopped">
        <splunk:run-export-search config-ref="Splunk" searchQuery="search * | head 10" earliestTime="-20d"
                                  latestTime="now" doc:name="Splunk"/>

        <vm:outbound-endpoint path="receive"/>
    </flow>

    <flow name="run-real-time-search" doc:name="run-real-time-search" initialState="stopped">
        <splunk:run-real-time-search searchQuery="search * | head 10" earliestTime="rt-1m" latestTime="rt"
                                     doc:name="Splunk"/>
        <vm:outbound-endpoint path="receive"/>
    </flow>

    <flow name="run-normal-search" doc:name="run-normal-search" initialState="stopped">
        <splunk:run-normal-search searchQuery="search * | head 100" doc:name="Splunk">
            <splunk:search-args>
                <splunk:search-arg key="auto_pause">0</splunk:search-arg>
            </splunk:search-args>
        </splunk:run-normal-search>
        <vm:outbound-endpoint path="receive"/>
    </flow>

    <flow name="get-inputs" doc:name="get-inputs">
        <splunk:get-inputs doc:name="Splunk"/>
    </flow>

    <flow name="create-input" doc:name="create-input">
        <splunk:create-input inputIdentifier="#[flowVars.inputIdentifier]" kind-ref="#[flowVars.kind]">
            <splunk:args ref="#[flowVars.args]"/>
        </splunk:create-input>
    </flow>

    <flow name="modify-input" doc:name="modify-input">
        <splunk:modify-input inputIdentifier="#[flowVars.inputIdentifier]" doc:name="Splunk">
            <splunk:input-args ref="#[flowVars.inputArgs]"/>
        </splunk:modify-input>
    </flow>
    <flow name="modify-index" doc:name="modify-index">
        <splunk:modify-index indexName="#[flowVars.indexName]" doc:name="Splunk">
            <splunk:index-args ref="#[flowVars.indexArgs]"/>
        </splunk:modify-index>
    </flow>
    <flow name="get-input" doc:name="get-input">
        <splunk:get-input inputIdentifier="#[flowVars.inputIdentifier]" doc:name="Splunk"/>
    </flow>
    <flow name="get-indexes" doc:name="get-indexes">
        <splunk:get-indexes sortKey="#[flowVars.sortKey]" sortDirection="#[flowVars.sortDirection]" doc:name="Splunk">
            <splunk:collection-parameters ref="#[flowVars.collectionParameters]"/>
        </splunk:get-indexes>
    </flow>
    <flow name="remove-input" doc:name="remove-input">
        <splunk:remove-input inputIdentifier="#[flowVars.inputIdentifier]" doc:name="Splunk"/>
    </flow>
    <flow name="remove-index" doc:name="remove-index">
        <splunk:remove-index indexName="#[flowVars.indexName]" doc:name="Splunk"/>
    </flow>

    <flow name="create-index" doc:name="create-index">
        <splunk:create-index indexName="#[flowVars.indexName]" doc:name="Splunk">
            <splunk:args ref="#[flowVars.args]"/>
        </splunk:create-index>
    </flow>
    <flow name="get-index" doc:name="get-index">
        <splunk:get-index indexIdentifier="#[flowVars.indexIdentifier]" doc:name="Splunk"/>
    </flow>
    <flow name="clean-index" doc:name="clean-index">
        <splunk:clean-index indexName="#[flowVars.indexName]" maxSeconds="#[flowVars.maxSeconds]" doc:name="Splunk"/>
    </flow>
    <flow name="add-data-to-index" doc:name="add-data-to-index">
        <splunk:add-data-to-index indexName="#[flowVars.indexName]" stringData="#[flowVars.stringData]"
                                  doc:name="Splunk">
            <splunk:index-args ref="#[flowVars.indexArgs]"/>
        </splunk:add-data-to-index>
    </flow>
    <flow name="add-data-to-tcp-input" doc:name="add-data-to-tcp-input">
        <splunk:add-data-to-tcp-input portNumber="#[flowVars.portNumber]" stringData="#[flowVars.stringData]"
                                      doc:name="Splunk"/>
    </flow>
    <flow name="add-data-to-udp-input" doc:name="add-data-to-udp-input">
        <splunk:add-data-to-udp-input portNumber="#[flowVars.portNumber]" stringData="#[flowVars.stringData]"
                                      doc:name="Splunk"/>
    </flow>
</mule>

