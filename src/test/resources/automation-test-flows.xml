<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:splunk="http://www.mulesoft.org/schema/mule/splunk"
      xmlns:context="http://www.springframework.org/schema/context"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
        http://www.mulesoft.org/schema/mule/splunk
        http://www.mulesoft.org/schema/mule/splunk/1.0.0-SNAPSHOT/mule-splunk.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-current.xsd">

    <context:property-placeholder location="automation-credentials.properties"/>


    <splunk:config host="${splunk.host}" port="${splunk.port}" username="${splunk.username}"
                   password="${splunk.password}"/>

    <flow name="testGetJobs">
        <splunk:get-jobs/>
    </flow>
    <flow name="testGetApplications">
        <splunk:get-applications/>
    </flow>
    <flow name="testRunNormalSearch">
        <splunk:run-normal-search searchQuery="#[payload.searchQuery]"/>
    </flow>
    <flow name="testRunOneShotSearch">
        <splunk:run-one-shot-search searchQuery="#[payload.searchQuery]"
                                    earliestTime="#[payload.earliestTime]" latestTime="#[payload.latestTime]"/>
    </flow>
    <flow name="testGetSavedSearches">
        <splunk:get-saved-searches/>
    </flow>
    <flow name="testCreateSavedSearch">
        <splunk:create-saved-search searchName="#[payload.searchName]" searchQuery="#[payload.searchQuery]"/>
    </flow>
    <flow name="testViewSavedSearch">
        <splunk:view-saved-search searchName="#[payload.searchName]"/>
    </flow>
    <flow name="testModifySavedSearch">
        <splunk:modify-saved-search searchName="#[payload.searchName]" description="#[payload.description]"
                                    isSetScheduled="#[payload.isSetScheduled]" cronSchedule="#[payload.cronSchedule]"/>
    </flow>
    <flow name="testGetSavedSearchHistory">
        <splunk:get-saved-search-history searchName="#[payload.searchName]" app="#[payload.app]"
                                         owner="#[payload.owner]"/>
    </flow>
    <flow name="testRunSavedSearch">
        <splunk:run-saved-search searchName="#[payload.searchName]"/>
    </flow>

    <flow name="testRunSavedSearchWithArgument">
        <splunk:run-saved-search-with-arguments searchName="#[payload.searchName]" searchQuery="#[payload.searchQuery]">
            <splunk:custom-args ref="#[payload.customArgs]"/>
            <splunk:search-dispatch-args ref="#[payload.searchDispatchArgs]"/>
        </splunk:run-saved-search-with-arguments>
    </flow>
    <flow name="testDeleteSavedSearch">
        <splunk:delete-saved-search searchName="#[payload.searchName]"/>
    </flow>

    <flow name="testGetDataModel">
        <splunk:get-data-model dataModelName="#[payload.dataModelName]"/>
    </flow>
    <flow name="testRunExportSearch">
        <splunk:run-export-search searchQuery="#[payload.searchQuery]">
            <splunk:export-args ref="#[payload.exportArgs]"/>
        </splunk:run-export-search>
    </flow>
    <flow name="testRunRealTimeSearch">
        <splunk:run-real-time-search searchQuery="#[payload.searchQuery]"/>
        <logger level="INFO" message="#[payload]"/>
    </flow>


</mule>
